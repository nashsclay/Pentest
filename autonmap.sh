#!/bin/bash

function check(){
   local OPTIND opt i
   while getopts "c:i:" opt; do
     case $opt in
       c) echo "$computerworkingon";computerworkingon="$OPTARG";;
       i) computerworkingip="$OPTARG";;
      \?) exit 1 ;;
     esac
   done
   shift $((OPTIND -1))
}


function main(){
check $@
DirUserPath="/home/$SUDO_USER/HTB/$computerworkingon"
RunningUserPath="/home/$SUDO_USER/HTB/$computerworkingon/$computerworkingon"
echo "***************************************************************************"
echo "Scripts will be stored in: $DirUserPath"
echo "***************************************************************************"
printf "\n"
# Leave in for testing .... read -p "Please confirm: $computerworkingon with IP address of $computerworkingip " confirm && [[ $confirm == [yY] || $confirm == [yY][eE][sS] ]] || exit 1
mkdir "$DirUserPath"
touch "$RunningUserPath"-ip
echo "$computerworkingip" | sudo tee "$RunningUserPath"-ip
echo "sudo nmap -sT -iL $RunningUserPath-ip -oA $RunningUserPath-sT"
printf "\n"
nmap -sT -iL "$RunningUserPath"-ip -oA "$RunningUserPath"-sT
printf "\n"
printf "\n"
echo "sudo nmap -sU --top-ports 100 -iL $RunningUserPath-ip -oA $RunningUserPath-sU"
printf "\n"
nmap -sU --top-ports 100 -iL "$RunningUserPath"-ip -oA "$RunningUserPath"-sU
printf "\n"
printf "\n"
echo "sudo nmap -sV -O -iL $RunningUserPath-ip -oA $RunningUserPath-sVO"
printf "\n"
nmap -sV -O -iL "$RunningUserPath"-ip -oA "$RunningUserPath"-sVO
printf "\n"
printf "\n"
echo "sudo nmap -A -iL $RunningUserPath-ip -oA $RunningUserPath-A"
printf "\n"
nmap -A -iL "$RunningUserPath"-ip -oA "$RunningUserPath"-A
printf "\n"
printf "\n"
echo "sudo nmap --script=default -iL $RunningUserPath-ip -oA $RunningUserPath-default"
printf "\n"
nmap --script=default -iL "$RunningUserPath"-ip -oA "$RunningUserPath"-default
printf "\n"
printf "\n"
echo "sudo nmap --script=vuln -iL $RunningUserPath-ip -oA $RunningUserPath-vuln"
printf "\n"
nmap --script=vuln -iL "$RunningUserPath"-ip -oA "$RunningUserPath"-vuln
printf "\n"
printf "\n"
echo "sudo nmap --script=auth -iL $RunningUserPath-ip -oA $RunningUserPath-auth"
printf "\n"
nmap --script=auth -iL "$RunningUserPath"-ip -oA "$RunningUserPath"-auth
printf "\n"
printf "\n"
echo "Your results can be found in $DirUserPath"
chown -R "$SUDO_USER":"$SUDO_USER" "$DirUserPath"
}

main $@
